var w=Object.defineProperty;var E=(e,t,n)=>t in e?w(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var r=(e,t,n)=>(E(e,typeof t!="symbol"?t+"":t,n),n),v=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)};var l=(e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)};var u=(e,t,n)=>(v(e,t,"access private method"),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}})();function B(){const e=document.documentElement,t=document.getElementById("toggle"),n=()=>{const i=t.checked?"dark":"light";e.setAttribute("data-theme",i)};return t.addEventListener("change",n),t}async function C(e){const t=await navigator.mediaDevices.getUserMedia({video:!0}),n=document.createElement("video");try{n.srcObject=t}catch{n.src=window.URL.createObjectURL(t)}return e&&n.addEventListener("canplay",()=>{I(n,e)}),await n.play(),n}function b(e,t){t.getContext("2d").drawImage(e,0,0,t.width,t.height)}function I(e,t){const n=t.getContext("2d");setInterval(()=>{n.drawImage(e,0,0,e.videoWidth,e.videoHeight,0,0,t.width,t.height)},16)}function L(e){const t=M(),n=e.getContext("2d");n.clearRect(0,0,e.width,e.height);for(let{text:i,x:o,y:s}of t){const c=e.width-10-o;n.fillStyle="white",n.strokeStyle="black",n.font="80px Impact",n.fillText(i,o,s,c),n.strokeText(i,o,s,c)}}function M(){const t={text:document.getElementById("text-top").value.toUpperCase(),x:10,y:90},i={text:document.getElementById("text-bottom").value.toUpperCase(),x:10,y:470};return[t,i]}class T{constructor(t,n,i){r(this,"element",document.createElement("form"));r(this,"heading",document.createElement("h2"));r(this,"closeButton",document.createElement("button"));this.element.setAttribute("type",t),this.heading.textContent=n,this.closeButton.setAttribute("type","submit"),this.closeButton.classList.add("secondary"),this.closeButton.textContent="Close",this.element.appendChild(this.heading),this.element.appendChild(i),this.element.appendChild(this.closeButton)}}var d,f,a,y;class h{constructor(t,n,i){l(this,d);l(this,a);r(this,"openButton",document.createElement("button"));r(this,"dialog",document.createElement("dialog"));this.name=t,this.openButton.setAttribute("id",t),this.openButton.textContent=t,this.parent=n,this.content=i,u(this,d,f).call(this),u(this,a,y).call(this)}render(){this.parent.replaceChildren(this.openButton),this.parent.appendChild(this.dialog)}}d=new WeakSet,f=function(){const t=document.createElement("article"),n=new T("dialog",this.name,this.content);t.appendChild(n.element),this.dialog.appendChild(t);const i=this.dialog;n.element.addEventListener("submit",function(o){o.preventDefault(),i.close()})},a=new WeakSet,y=function(){const t=this.dialog;this.openButton.addEventListener("click",()=>{t.showModal()})};const m=document.getElementById("meme"),g=document.createElement("canvas"),p=document.createElement("canvas");for(let e of[g,p])e.width=m.width,e.height=m.height;function x(){const e=m.getContext("2d");e.drawImage(g,0,0),e.drawImage(p,0,0)}function S(){const e=document.getElementById("settings");B(),new h("Settings",e,e.querySelector(".modal-content")).render()}function k(){const e=document.getElementById("add-text");document.getElementById("text-save").addEventListener("click",()=>{L(p),x()}),new h("Add some text",e,e.querySelector(".modal-content")).render()}async function O(){const e=document.getElementById("take-selfie"),t=document.getElementById("save-photo");new h("Take a selfie",e,e.querySelector(".modal-content")).render();const i=document.getElementById("preview"),o=await C(i);t.addEventListener("click",()=>{b(o,g),x()})}(async function(){S(),k(),await O()})();
